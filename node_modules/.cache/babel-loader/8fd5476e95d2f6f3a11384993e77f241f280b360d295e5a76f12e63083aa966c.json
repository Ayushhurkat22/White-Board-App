{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ayush Hurkat\\\\Documents\\\\whiteboard-app\\\\src\\\\components\\\\Board\\\\index.js\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useLayoutEffect, useRef } from \"react\";\nimport rough from \"roughjs\";\nimport boardContext from \"../../store/board-context\";\nimport { TOOL_ACTION_TYPES, TOOL_ITEMS } from \"../../constants\";\nimport toolboxContext from \"../../store/toolbox-context\";\nimport classes from \"./index.module.css\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Board() {\n  _s();\n  var _elements, _elements2;\n  const canvasRef = useRef();\n  const textAreaRef = useRef();\n  const {\n    elements,\n    toolActionType,\n    boardMouseDownHandler,\n    boardMouseMoveHandler,\n    boardMouseUpHandler,\n    textAreaBlurHandler,\n    undo,\n    redo\n  } = useContext(boardContext);\n  const {\n    toolboxState\n  } = useContext(toolboxContext);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    canvas.width = window.innerWidth;\n    canvas.height = window.innerHeight;\n  }, []);\n  useEffect(() => {\n    function handleKeyDown(event) {\n      if (event.ctrlKey && event.key === \"z\") {\n        undo();\n      } else if (event.ctrlKey && event.key === \"y\") {\n        redo();\n      }\n    }\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => {\n      document.removeEventListener(\"keydown\", handleKeyDown);\n    };\n  }, [undo, redo]);\n  useLayoutEffect(() => {\n    const canvas = canvasRef.current;\n    const context = canvas.getContext(\"2d\");\n    context.save();\n    const roughCanvas = rough.canvas(canvas);\n    elements.forEach(element => {\n      switch (element.type) {\n        case TOOL_ITEMS.LINE:\n        case TOOL_ITEMS.RECTANGLE:\n        case TOOL_ITEMS.CIRCLE:\n        case TOOL_ITEMS.ARROW:\n          roughCanvas.draw(element.roughEle);\n          break;\n        case TOOL_ITEMS.BRUSH:\n          context.fillStyle = element.stroke;\n          context.fill(element.path);\n          context.restore();\n          break;\n        case TOOL_ITEMS.TEXT:\n          context.textBaseline = \"top\";\n          context.font = `${element.size}px Caveat`;\n          context.fillStyle = element.stroke;\n          context.fillText(element.text, element.x1, element.y1);\n          context.restore();\n          break;\n        default:\n          throw new Error(\"Type not recognized\");\n      }\n    });\n    return () => {\n      context.clearRect(0, 0, canvas.width, canvas.height);\n    };\n  }, [elements]);\n  useEffect(() => {\n    const textarea = textAreaRef.current;\n    if (toolActionType === TOOL_ACTION_TYPES.WRITING) {\n      setTimeout(() => {\n        textarea.focus();\n      }, 0);\n    }\n  }, [toolActionType]);\n  const handleMouseDown = event => {\n    boardMouseDownHandler(event, toolboxState);\n  };\n  const handleMouseMove = event => {\n    boardMouseMoveHandler(event);\n  };\n  const handleMouseUp = () => {\n    boardMouseUpHandler();\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [toolActionType === TOOL_ACTION_TYPES.WRITING && /*#__PURE__*/_jsxDEV(\"textarea\", {\n      type: \"text\",\n      ref: textAreaRef,\n      className: classes.textElementBox,\n      style: {\n        top: elements[elements.length - 1].y1,\n        left: elements[elements.length - 1].x1,\n        fontSize: `${(_elements = elements[elements.length - 1]) === null || _elements === void 0 ? void 0 : _elements.size}px`,\n        color: (_elements2 = elements[elements.length - 1]) === null || _elements2 === void 0 ? void 0 : _elements2.stroke\n      },\n      onBlur: event => textAreaBlurHandler(event.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      id: \"canvas\",\n      onMouseDown: handleMouseDown,\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Board, \"zNF7602O4OKy+KKloApZ92Qa/o8=\");\n_c = Board;\nexport default Board;\nvar _c;\n$RefreshReg$(_c, \"Board\");","map":{"version":3,"names":["useContext","useEffect","useLayoutEffect","useRef","rough","boardContext","TOOL_ACTION_TYPES","TOOL_ITEMS","toolboxContext","classes","jsxDEV","_jsxDEV","Fragment","_Fragment","Board","_s","_elements","_elements2","canvasRef","textAreaRef","elements","toolActionType","boardMouseDownHandler","boardMouseMoveHandler","boardMouseUpHandler","textAreaBlurHandler","undo","redo","toolboxState","canvas","current","width","window","innerWidth","height","innerHeight","handleKeyDown","event","ctrlKey","key","document","addEventListener","removeEventListener","context","getContext","save","roughCanvas","forEach","element","type","LINE","RECTANGLE","CIRCLE","ARROW","draw","roughEle","BRUSH","fillStyle","stroke","fill","path","restore","TEXT","textBaseline","font","size","fillText","text","x1","y1","Error","clearRect","textarea","WRITING","setTimeout","focus","handleMouseDown","handleMouseMove","handleMouseUp","children","ref","className","textElementBox","style","top","length","left","fontSize","color","onBlur","target","value","fileName","_jsxFileName","lineNumber","columnNumber","id","onMouseDown","onMouseMove","onMouseUp","_c","$RefreshReg$"],"sources":["C:/Users/Ayush Hurkat/Documents/whiteboard-app/src/components/Board/index.js"],"sourcesContent":["import { useContext, useEffect, useLayoutEffect, useRef } from \"react\";\r\nimport rough from \"roughjs\";\r\nimport boardContext from \"../../store/board-context\";\r\nimport { TOOL_ACTION_TYPES, TOOL_ITEMS } from \"../../constants\";\r\nimport toolboxContext from \"../../store/toolbox-context\";\r\n\r\nimport classes from \"./index.module.css\";\r\n\r\nfunction Board() {\r\n  const canvasRef = useRef();\r\n  const textAreaRef = useRef();\r\n  const {\r\n    elements,\r\n    toolActionType,\r\n    boardMouseDownHandler,\r\n    boardMouseMoveHandler,\r\n    boardMouseUpHandler,\r\n    textAreaBlurHandler,\r\n    undo,\r\n    redo,\r\n  } = useContext(boardContext);\r\n  const { toolboxState } = useContext(toolboxContext);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    function handleKeyDown(event) {\r\n      if (event.ctrlKey && event.key === \"z\") {\r\n        undo();\r\n      } else if (event.ctrlKey && event.key === \"y\") {\r\n        redo();\r\n      }\r\n    }\r\n\r\n    document.addEventListener(\"keydown\", handleKeyDown);\r\n\r\n    return () => {\r\n      document.removeEventListener(\"keydown\", handleKeyDown);\r\n    };\r\n  }, [undo, redo]);\r\n\r\n  useLayoutEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const context = canvas.getContext(\"2d\");\r\n    context.save();\r\n\r\n    const roughCanvas = rough.canvas(canvas);\r\n\r\n    elements.forEach((element) => {\r\n      switch (element.type) {\r\n        case TOOL_ITEMS.LINE:\r\n        case TOOL_ITEMS.RECTANGLE:\r\n        case TOOL_ITEMS.CIRCLE:\r\n        case TOOL_ITEMS.ARROW:\r\n          roughCanvas.draw(element.roughEle);\r\n          break;\r\n        case TOOL_ITEMS.BRUSH:\r\n          context.fillStyle = element.stroke;\r\n          context.fill(element.path);\r\n          context.restore();\r\n          break;\r\n        case TOOL_ITEMS.TEXT:\r\n          context.textBaseline = \"top\";\r\n          context.font = `${element.size}px Caveat`;\r\n          context.fillStyle = element.stroke;\r\n          context.fillText(element.text, element.x1, element.y1);\r\n          context.restore();\r\n          break;\r\n        default:\r\n          throw new Error(\"Type not recognized\");\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      context.clearRect(0, 0, canvas.width, canvas.height);\r\n    };\r\n  }, [elements]);\r\n\r\n  useEffect(() => {\r\n    const textarea = textAreaRef.current;\r\n    if (toolActionType === TOOL_ACTION_TYPES.WRITING) {\r\n      setTimeout(() => {\r\n        textarea.focus();\r\n      }, 0);\r\n    }\r\n  }, [toolActionType]);\r\n\r\n  const handleMouseDown = (event) => {\r\n    boardMouseDownHandler(event, toolboxState);\r\n  };\r\n\r\n  const handleMouseMove = (event) => {\r\n    boardMouseMoveHandler(event);\r\n  };\r\n\r\n  const handleMouseUp = () => {\r\n    boardMouseUpHandler();\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {toolActionType === TOOL_ACTION_TYPES.WRITING && (\r\n        <textarea\r\n          type=\"text\"\r\n          ref={textAreaRef}\r\n          className={classes.textElementBox}\r\n          style={{\r\n            top: elements[elements.length - 1].y1,\r\n            left: elements[elements.length - 1].x1,\r\n            fontSize: `${elements[elements.length - 1]?.size}px`,\r\n            color: elements[elements.length - 1]?.stroke,\r\n          }}\r\n          onBlur={(event) => textAreaBlurHandler(event.target.value)}\r\n        />\r\n      )}\r\n      <canvas\r\n        ref={canvasRef}\r\n        id=\"canvas\"\r\n        onMouseDown={handleMouseDown}\r\n        onMouseMove={handleMouseMove}\r\n        onMouseUp={handleMouseUp}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Board;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}